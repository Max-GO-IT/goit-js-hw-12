{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44433569-eda6d7623baf54ab2611b04f8'; // Замените на свой ключ API Pixabay\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        page,\n        per_page: 15, // Количество изображений на страницу\n        image_type:'photo',\n        orientation:'horizontal',\n        safesearch:'true',\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Ошибка получения данных:', error);\n    return []; // Возвращаем пустой массив в случае ошибки\n  }\n}\n\n\n\n\nexport function fetchImages2(query) {\n  const url = `https://pixabay.com/api/?key=44433569-eda6d7623baf54ab2611b04f8&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`;\n\n  return fetch(url)\n    .then(response => {\n      if (!response.ok) {\n        throw new Error('Не вдалося отримати дані від Pixabay API');\n      }\n      return response.json();\n    })\n    .then(data => {\n      if (data.hits.length === 0) {\n        iziToast.info({\n          title: 'Не знайдено зображень!',\n          message: 'На жаль, немає зображень, що відповідають вашому пошуковому запиту. Спробуйте ще раз!',\n        });\n        throw new Error('Не знайдено зображень'); \n      }\n      return data.hits;\n    })\n    .catch(error => {\n      iziToast.error({\n        title: 'Помилка!',\n        message: error.message,\n      });\n      throw error; \n    });\n}","export function renderImages(images) {\n  const gallery = document.querySelector('#gallery');\n  const markup = images.hits.map(image => `\n    <div class=\"photo-card\">\n      <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>${image.likes}</b> likes\n        </p>\n        <p class=\"info-item\">\n          <b>${image.views}</b> views\n        </p>\n        <p class=\"info-item\">\n          <b>${image.comments}</b> comments\n        </p>\n        <p class=\"info-item\">\n          <b>${image.downloads}</b> downloads\n        </p>\n      </div>\n    </div>\n  `).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderImages } from './js/render-functions.js';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst searchForm = document.querySelector('#search-form');\nconst formButton = document.querySelector('.form-button'); \nconst nextButton = document.querySelector('.next-button'); \n\n\nconst gallery = document.querySelector('#gallery');\nconst loading = document.querySelector('#loading');\nloading.style.display = \"none\";\n\nlet lightbox = null;\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\nlet searchQueryTemp = '';\n\nfunction showNoImagesMessage() {\n  iziToast.info({\n    title: 'Не знайдено зображень!',\n    message: 'На жаль, немає зображень, що відповідають вашому пошуковому запиту. Спробуйте ще раз!',\n  });\n  currentPage = 1;\n  nextButton.classList.add('hidden')\n}\n\n\nfunction handleError(error) {\n  loading.style.display = \"none\";\n  if (error.response && error.response.status === 404) {\n    showNoImagesMessage();\n  } else {\n    iziToast.error({\n      title: 'Помилка!',\n      message: 'Виникла помилка під час отримання даних. Перевірте своє підключення до інтернету або спробуйте пізніше.',\n    });\n  }\n  nextButton.classList.add('hidden');\n}\n\n\nsearchForm.addEventListener('submit', (event) => {\n  event.preventDefault();\n  const searchQuery = document.querySelector('#search-input').value.trim();\n \n  \n   \n   if (searchQuery === '') {\n            iziToast.warning({\n              title: 'Введіть запит!',\n              message: 'Будь ласка, введіть пошуковий запит',\n            });\n          return;\n         }\n\n    gallery.innerHTML = '';\n    currentPage = 1;\n    searchQueryTemp=searchQuery; \n    nextButton.classList.remove('hidden')\n   \n \n  console.log(currentPage);\n  loading.classList.remove('hidden');\n  loading.style.display = \"block\";\n\n  fetchImages(searchQueryTemp,currentPage)\n    .then(images => {\n      totalHits = images.totalHits;\n      if (images.hits.length === 0) {\n        showNoImagesMessage();\n        return; \n      }\n\n      renderImages(images);\n      \n      if (!lightbox) {\n        lightbox = new SimpleLightbox('.gallery-link', {\n          captionDelay: 250,\n          captionPosition: 'bottom',\n          captionType: 'attr',\n          captionsData: 'alt',\n        });\n      } else {\n        lightbox.refresh(); \n      }\n      \n      if(totalHits>((currentPage-1)*15))\n        {\n          nextButton.classList.remove('hidden');\n        }\n      else\n        {\n          nextButton.classList.add('hidden');\n        } \n\n\n    })\n    .then(() => {\n      loading.style.display = \"none\";\n    })\n    .catch(handleError);\n});\n\nnextButton.addEventListener('click', (event) => {\n  event.preventDefault();\n  \n    currentPage =currentPage + 1;\n\n \n  console.log(currentPage);\n  loading.classList.remove('hidden');\n  loading.style.display = \"block\";\n\n  fetchImages(searchQueryTemp,currentPage)\n    .then(images => {\n      if (images.hits.length === 0) {\n        totalHits = (currentPage-1) * 15;\n        iziToast.info({\n          title: 'Більше зображень немає!',\n          message: 'Ви досягли кінця результатів пошуку.',\n        });\n        nextButton.classList.add('hidden'); \n\n        return; \n      }\n\n      renderImages(images);\n      \n      if (!lightbox) {\n        lightbox = new SimpleLightbox('.gallery-link', {\n          captionDelay: 250,\n          captionPosition: 'bottom',\n          captionType: 'attr',\n          captionsData: 'alt',\n        });\n      } else {\n        lightbox.refresh(); \n      }\n      \n      if(totalHits>((currentPage-1)*15))\n        {\n          nextButton.classList.remove('hidden');\n        }\n      else\n        {\n          nextButton.classList.add('hidden');\n        }\n\n\n    })\n    .then(() => {\n      loading.style.display = \"none\";\n    })\n    .catch(handleError);\n});\n\n\n\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","axios","error","renderImages","images","gallery","markup","image","searchForm","nextButton","loading","lightbox","currentPage","totalHits","searchQueryTemp","showNoImagesMessage","iziToast","handleError","event","searchQuery","SimpleLightbox"],"mappings":"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"}